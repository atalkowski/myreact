<html xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">
<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<style>
<!--
 /* Font Definitions */
 @font-face
        {font-family:Wingdings;
        panose-1:5 0 0 0 0 0 0 0 0 0;
        }
@font-face
        {font-family:"Cambria Math";
        panose-1:2 4 5 3 5 4 6 3 2 4;
        }
@font-face
        {font-family:Calibri;
        panose-1:2 15 5 2 2 2 4 3 2 4;
        }
@font-face
        {font-family:"Calibri Light";
        panose-1:2 15 3 2 2 2 4 3 2 4;
        }
@font-face
        {font-family:Verdana;
        panose-1:2 11 6 4 3 5 4 4 2 4;
        }
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
        {
        margin:0in;
        font-size:14.0pt;
        font-family:"Calibri",sans-serif;
        }
h2
        {
        margin-right:0in;
        margin-left:0in;
        font-size:20.0pt;
        font-family:"Times New Roman",serif;
        font-weight:bold;}
h3
        {
        margin-top:2.0pt;
        margin-right:0in;
        margin-bottom:0in;
        margin-left:0in;
        page-break-after:avoid;
        font-size:18.0pt;
        font-family:"Calibri Light",sans-serif;
        color:#1F3763;
        font-weight:normal;}
h4
        {
        margin-top:2.0pt;
        margin-right:0in;
        margin-bottom:0in;
        margin-left:0in;
        page-break-after:avoid;
        font-size:16.0pt;
        font-family:"Calibri Light",sans-serif;
        color:#2F5496;
        font-weight:normal;
        font-style:italic;}

.bluey {color: #000060;}

h5     {
        margin-top:2.0pt;
        margin-right:0in;
        margin-bottom:0in;
        margin-left:0in;
        page-break-after:avoid;
        font-size:14.0pt;
        font-family:"Calibri Light",sans-serif;
        color:#000000;
        font-weight:bolder;}
a:link, span.MsoHyperlink
        {
        color:blue;
        text-decoration:underline;
        text-underline:single;}
a:visited, span.MsoHyperlinkFollowed
        {
        color:#954F72;
        text-decoration:underline;
        text-underline:single;}
p, p.MyNormal
        {
        margin-top:1.0pt;
        margin-right:0in;
        margin-left:0.1in;
        font-size:15.0pt;
        font-family:"Times New Roman",serif;
        }
code
        {
        font-family:"Courier New";
        }
pre
        {
        margin:0in;
        tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 2213.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
        font-size:15.0pt;
        font-family:"Courier New";
        }
span.Heading2Char
        {
        font-family:"Times New Roman",serif;
        font-weight:bold;}
span.HTMLPreformattedChar
        {
        font-family:"Courier New";
        }
span.Heading3Char
        {
        font-family:"Calibri Light",sans-serif;
        color:#1F3763;
        }
span.Heading4Char
        {
        font-family:"Calibri Light",sans-serif;
        color:#2F5496;
        font-style:italic;}
span.Heading5Char/MsoNormal
        {
        font-family:"Calibri Light",sans-serif;
        color:#2F5496;
        }
span.SpellE
        {
        }
span.GramE
        {
        }
.MsoChpDefault
        {
        font-family:"Calibri",sans-serif;
        }
@page WordSection1
        {size:8.5in 11.0in;
        margin:1.0in 1.0in 1.0in 1.0in;
        }
div.WordSection1
        {page:WordSection1;}
 /* List Definitions */
ol
        {margin-bottom:0in;}
ul
        {margin-bottom:0in;}
-->
</style>
</head>
<body lang=EN-US link=blue vlink="#954F72" style='tab-interval:.5in;word-wrap:
break-word'>
<div class=WordSection1>
<h2>Purpose</h2>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>This
document describes user-facing facets of the Hadoop
MapReduce framework and serves as a tutorial. See the original here which
covers other issues and more complex examples: <a href="https://hadoop.apache.org/docs/stable/hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html">Map reduce page.</a></span>
</p>
<h5 class=bluey>Prerequisites</h5>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>Ensure
that Hadoop is installed, <span class=GramE>configured</span> and is running.
More details:<o:p></o:p></span></p>
<ul type=disc>
 <li class=MyNormal  style='color:black;mso-margin-bottom-alt:
     auto;tab-stops:list .5in'>
    <span style='font-family:"Verdana",sans-serif;
     mso-ligatures:
     none'><a
     href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html"><span
     style='color:#4477AA'>Single Node Setup</span></a>&nbsp;for first-time
     users.<o:p></o:p></span></li>
 <li class=MyNormal  style='color:black;mso-margin-bottom-alt:
     auto;tab-stops:list .5in'>
    <span style='font-family:"Verdana",sans-serif;
     mso-ligatures:
     none'><a
     href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/ClusterSetup.html"><span
     style='color:#4477AA'>Cluster Setup</span></a>&nbsp;for large, distributed
     clusters.<o:p></o:p></span></li>
</ul>
<h2>Overview</h2>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>Hadoop
MapReduce is a software framework for easily writing applications which process
vast amounts of data (multi-terabyte <span class=GramE>data-sets</span>)
in-parallel on large clusters (thousands of nodes) of commodity hardware in a
reliable, fault-tolerant manner.<o:p></o:p></span></p>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>A
MapReduce&nbsp;<i>job</i>&nbsp;usually splits the input <span class=GramE>data-set</span>
into independent chunks which are processed by the&nbsp;<i>map tasks</i>&nbsp;in
a completely parallel manner. The framework sorts the outputs of the maps,
which are then input to the&nbsp;<i>reduce tasks</i>. <span class=GramE>Typically</span>
both the input and the output of the job are stored in a file-system. The
framework takes care of scheduling tasks, monitoring them and re-executes the
failed tasks.<o:p></o:p></span></p>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>Typically
the compute nodes and the storage nodes are the same, that is, the MapReduce
framework and the Hadoop Distributed File System (see&nbsp;<a
href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-hdfs/HdfsDesign.html"><span
style='color:#4477AA'>HDFS Architecture Guide</span></a>) are running on the
same set of nodes. This configuration allows the framework to effectively
schedule tasks on the nodes where data is already present, resulting in very
high aggregate bandwidth across the cluster.<o:p></o:p></span></p>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>The
MapReduce framework consists of a single master&nbsp;</span><span class=SpellE><span
style='font-family:"Courier New";
color:black;mso-ligatures:none'>ResourceManager</span></span><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>, one
worker&nbsp;</span><span class=SpellE>
    <span style='font-family:
"Courier New";mso-font-kerning:
0pt;
font-family:"Times New Roman",serif;
color:black;per cluster-node,
and&nbsp;</span><span class=SpellE>
    <span style='font-family:
"Courier New";mso-font-kerning:
0pt;
font-family:"Times New Roman",serif;
color:black;per application
(see&nbsp;<a
href="https://hadoop.apache.org/docs/stable/hadoop-yarn/hadoop-yarn-site/YARN.html"><span
style='color:#4477AA'>YARN Architecture Guide</span></a>).<o:p></o:p></span></p>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>Minimally,
applications specify the input/output locations and supply&nbsp;<i>map</i>&nbsp;and&nbsp;<i>reduce</i>&nbsp;functions
via implementations of appropriate interfaces and/or <span class=GramE>abstract-classes</span>.
These, and other job parameters, comprise the&nbsp;<i>job configuration</i>.<o:p></o:p></span></p>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>The
Hadoop&nbsp;<i>job client</i>&nbsp;then submits the job (jar/executable etc.)
and configuration to the&nbsp;</span><span class=SpellE>
    <span style='font-size:13.0pt;font-family:"Courier New";
color:black;mso-ligatures:none'>ResourceManager</span></span><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;which
then assumes the responsibility of distributing the software/configuration to
the workers, scheduling <span class=GramE>tasks</span> and monitoring them,
providing status and diagnostic information to the job-client.<o:p></o:p></span></p>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>Although
the Hadoop framework is implemented in Java™, MapReduce applications need not
be written in Java.<o:p></o:p></span></p>
<ul type=disc>
 <li class=MyNormal  style='color:black;mso-margin-bottom-alt:
     auto;tab-stops:list .5in'>
    <span style='font-size: 13.0pt;font-family:"Verdana",sans-serif;
     mso-ligatures:
     none'><a
     href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/streaming/package-summary.html"><span
     style='color:#4477AA'>Hadoop Streaming</span></a>&nbsp;is a utility which
     allows users to create and run jobs with any executables (<span
     class=GramE>e.g.</span> shell utilities) as the mapper and/or the reducer.<o:p></o:p></span></li>
 <li class=MyNormal  style='color:black;mso-margin-bottom-alt:
     auto;tab-stops:list .5in'>
    <span style='font-size: 13.0pt;font-family:"Verdana",sans-serif;
     mso-ligatures:
     none'><a
     href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapred/pipes/package-summary.html"><span
     style='color:#4477AA'>Hadoop Pipes</span></a>&nbsp;is a&nbsp;<a
     href="http://www.swig.org/">
    <span style='color:#4477AA'>SWIG</span></a>-compatible
     C++ API to implement MapReduce applications (non JNI™ based).<o:p></o:p></span></li>
</ul>
<p class=MyNormal  style='
mso-outline-level:2'><a name="Inputs_and_Outputs"></a><b><span
style='font-size:18.0pt;font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:#333333;mso-ligatures:none'>Inputs
and Outputs<o:p></o:p></span></b></p>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>The
MapReduce framework operates exclusively on&nbsp;</span>
    <span style='font-size: 13.0pt;font-family:"Courier New";
color:black;</span><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;pairs,
that is, the framework views the input to the job as a set of&nbsp;</span><span
style='font-family:"Courier New";
color:black;</span><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;pairs
and produces a set of&nbsp;</span>
    <span style='font-family:
"Courier New";mso-font-kerning:
0pt;
font-family:"Times New Roman",serif;
color:black;pairs as the output
of the job, conceivably of different types.<o:p></o:p></span></p>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;</span><span
style='font-family:"Courier New";
color:black;mso-ligatures:none'>key</span><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;</span><span
style='font-family:"Courier New";
color:black;mso-ligatures:none'>value</span><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;classes
have to be serializable by the framework and hence need to implement the&nbsp;<a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/io/Writable.html"><span
style='color:#4477AA'>Writable</span></a>&nbsp;interface. Additionally, the key
classes have to implement the&nbsp;<span class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/io/WritableComparable.html"><span
style='color:#4477AA'>WritableComparable</span></a></span>&nbsp;interface to
facilitate sorting by the framework.<o:p></o:p></span></p>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;mso-ligatures:none'>Input
and Output types of a MapReduce job:<o:p></o:p></span></p>
<p class=MyNormal  style='mso-margin-bottom-alt:auto'><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;</span><span
style='font-family:"Courier New";
color:black;</span><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;</span><span
style='font-family:"Courier New";
color:black;</span><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;</span><span
style='font-family:"Courier New";
color:black;</span><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;</span><span
style='font-family:"Courier New";
color:black;</span><span
style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";color:black;(output)<o:p></o:p></span></p>
<p class=MyNormal  style='
background:white'><a name="Example:_WordCount_v1.0"></a><b><span
style='font-size:18.0pt;font-family:"Verdana",sans-serif;mso-fareast-font-family:
"Times New Roman";
mso-ligatures:none'>Example: <span class=SpellE>WordCount</span>
v1.0<o:p></o:p></span></b></p>
<p class=MyNormal  style='
background:white'>
    <span style='font-family:"Verdana",sans-serif;
color:black;mso-ligatures:none'>Before we jump into the
details, lets walk through an example MapReduce application to get a <span
class=SpellE>flavour</span> for how they work. <o:p></o:p></span></p>
<p class=MyNormal  style='
background:white'><span class=SpellE>
    <span style='font-family:
"Courier New";mso-font-kerning:
0pt;
font-family:"Verdana",sans-serif;
is a simple application that counts the number of
occurrences of each word <span class=GramE>in a given</span> input set.<o:p></o:p></span></p>
<p class=MyNormal  style='
background:white'>
    <span style='font-family:"Verdana",sans-serif;
color:black;mso-ligatures:none'>This works with a
local-standalone, pseudo-distributed or fully-distributed Hadoop installation (<a
href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html"><span
style='color:#4477AA'>Single Node Setup</span></a>).<o:p></o:p></span></p>
<table class=MsoTableGrid border=1 cellspacing=0 cellpadding=0
 style='border-collapse:collapse;border:none;
 mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr style='mso-yfti-lastrow:yes'>
  <td width=623 valign=top style='width:467.5pt;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt'><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>java.io.IOException</span></span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>java.util</span>.StringTokenizer</span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>org.apache</span>.hadoop.conf.Configuration</span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>org.apache</span>.hadoop.fs.Path</span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>org.apache.hadoop.io.IntWritable</span></span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>org.apache.hadoop.io.Text</span></span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>org.apache</span>.hadoop.mapreduce.Job</span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>org.apache</span>.hadoop.mapreduce.Mapper</span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>org.apache</span>.hadoop.mapreduce.Reducer</span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>org.apache.hadoop.mapreduce.lib.input</span>.FileInputFormat</span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>import <span class=SpellE><span
  class=GramE>org.apache.hadoop.mapreduce.lib.output</span>.FileOutputFormat</span>;<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>public class <span
  class=SpellE>WordCount</span> {<o:p></o:p></span></pre><pre style='background:
  white'>
    <span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span>public static class <span
  class=SpellE>TokenizerMapper</span><o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='Object, Text, Text, <span
  class=SpellE>IntWritable</span><span class=GramE>&gt;{</span><o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span>private final static <span
  class=SpellE>IntWritable</span> one = new <span class=SpellE><span
  class=GramE>IntWritable</span></span><span class=GramE>(</span>1);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span>private Text word = new <span
  class=GramE>Text(</span>);<o:p></o:p></span></pre><pre style='background:
  white'>
    <span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span>public void <span
  class=GramE>map(</span>Object key, Text value, Context <span class=SpellE>context</span><o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>                    </span>) <span
  class=GramE>throws</span> <span class=SpellE>IOException</span>, <span
  class=SpellE>InterruptedException</span> {<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>      </span><span
  class=SpellE>StringTokenizer</span> <span class=SpellE>itr</span> = new <span
  class=SpellE>StringTokenizer</span>(<span class=SpellE><span class=GramE>value.toString</span></span>());<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>      </span>while (<span
  class=SpellE><span class=GramE>itr.hasMoreTokens</span></span>()) {<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>        </span><span
  class=SpellE>word.set</span>(<span class=SpellE><span class=GramE>itr.nextToken</span></span>());<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>        </span><span
  class=SpellE><span class=GramE>context.write</span></span>(word, one);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>      </span>}<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span>public static class <span
  class=SpellE>IntSumReducer</span><o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='<span
  class=SpellE><span class=GramE>Text,IntWritable</span>,Text,IntWritable</span>&gt; {<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span>private <span
  class=SpellE>IntWritable</span> result = new <span class=SpellE><span
  class=GramE>IntWritable</span></span><span class=GramE>(</span>);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span>public void <span
  class=GramE>reduce(</span>Text key, <span class=SpellE>Iterable</span>&lt;<span
  class=SpellE>IntWritable</span>&gt; values,<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>                       </span>Context <span
  class=SpellE>context</span><o:p></o:p></span></pre><pre style='background:
  white'>
    <span style='color:black'><span style='mso-spacerun:yes'>                       </span>) <span
  class=GramE>throws</span> <span class=SpellE>IOException</span>, <span
  class=SpellE>InterruptedException</span> {<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>      </span>int sum = <span
  class=GramE>0;</span><o:p></o:p></span></pre><pre style='background:white'><span
  style='color:black'>
    <span style='mso-spacerun:yes'>      </span>for (<span
  class=SpellE>IntWritable</span> <span class=SpellE><span class=GramE>val</span></span><span
  class=GramE> :</span> values) {<o:p></o:p></span></pre><pre style='background:
  white'>
    <span style='color:black'><span style='mso-spacerun:yes'>        </span>sum += <span
  class=SpellE><span class=GramE>val.get</span></span><span class=GramE>(</span>);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>      </span>}<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>      </span><span
  class=SpellE>result.set</span>(sum<span class=GramE>);</span><o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>      </span><span
  class=SpellE><span class=GramE>context.write</span></span>(key, result);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span>}<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><o:p>&nbsp;</o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span>public static void <span
  class=GramE>main(</span>String[] <span class=SpellE>args</span>) throws Exception {<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span>Configuration conf = new <span
  class=GramE>Configuration(</span>);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span>Job <span
  class=SpellE>job</span> = <span class=SpellE>Job.getInstance</span>(conf, &quot;word count&quot;<span
  class=GramE>);</span><o:p></o:p></span></pre><pre style='background:white'><span
  style='color:black'>
    <span style='mso-spacerun:yes'>    </span><span
  class=SpellE><span class=GramE>job.setJarByClass</span></span>(<span
  class=SpellE>WordCount.class</span>);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
  class=SpellE><span class=GramE>job.setMapperClass</span></span>(<span
  class=SpellE>TokenizerMapper.class</span>);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
  class=SpellE><span class=GramE>job.setCombinerClass</span></span>(<span
  class=SpellE>IntSumReducer.class</span>);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
  class=SpellE><span class=GramE>job.setReducerClass</span></span>(<span
  class=SpellE>IntSumReducer.class</span>);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
  class=SpellE><span class=GramE>job.setOutputKeyClass</span></span>(<span
  class=SpellE>Text.class</span>);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
  class=SpellE><span class=GramE>job.setOutputValueClass</span></span>(<span
  class=SpellE>IntWritable.class</span>);<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
  class=SpellE>FileInputFormat.addInputPath</span>(job, new Path(<span
  class=SpellE><span class=GramE>args</span></span><span class=GramE>[</span>0]));<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
  class=SpellE>FileOutputFormat.setOutputPath</span>(job, new Path(<span
  class=SpellE><span class=GramE>args</span></span><span class=GramE>[</span>1]));<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
  class=SpellE>System.exit</span>(<span class=SpellE><span class=GramE>job.waitForCompletion</span></span>(true) ? <span
  class=GramE>0 :</span> 1);<o:p></o:p></span></pre><pre style='background:
  white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></pre><pre
  style='background:white'>
    <span style='color:black'>}<o:p></o:p></span></pre></td>
 </tr>
</table>
<p class=MyNormal >
    <span style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";</o:p></span></p>
<h4>Code walkthrough.</h4>
<p style='line-height:inherit;background:white'>
    <span style='
font-family:"Verdana",sans-serif;color:black'>The&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>WordCount</span></code></span><span
style='font-family:"Verdana",sans-serif;color:black'>&nbsp;application
is quite straight-forward.<o:p></o:p></span></p>
<pre style='background:white'>
    <span style='color:black'>public void <span
class=GramE>map(</span>Object key, Text value, Context <span class=SpellE>context</span><o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>                </span>) <span
class=GramE>throws</span> <span class=SpellE>IOException</span>, <span
class=SpellE>InterruptedException</span> {<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span><span
class=SpellE>StringTokenizer</span> <span class=SpellE>itr</span> = new <span
class=SpellE>StringTokenizer</span>(<span class=SpellE><span class=GramE>value.toString</span></span>());<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span>while (<span
class=SpellE><span class=GramE>itr.hasMoreTokens</span></span>()) {<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
class=SpellE>word.set</span>(<span class=SpellE><span class=GramE>itr.nextToken</span></span>());<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
class=SpellE><span class=GramE>context.write</span></span>(word, one);<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>}<o:p></o:p></span></pre>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>The&nbsp;</span><code>
    <span style='color:black'>Mapper</span></code><span
style='font-family:"Verdana",sans-serif;color:black'>&nbsp;implementation,
via the&nbsp;</span><code>
    <span style='color:black'>map</span></code><span
style='font-family:"Verdana",sans-serif;color:black'>&nbsp;method,
processes one line at a time, as provided by the specified&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>TextInputFormat</span></code></span><span
style='font-family:"Verdana",sans-serif;color:black'>. It then
splits the line into tokens separated by whitespaces, via the&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>StringTokenizer</span></code></span><span
style='font-family:"Verdana",sans-serif;color:black'>, and
emits a key-value pair of&nbsp;</span><code>
    <span style='
color:black'>&lt; &lt;word&gt;, 1&gt;</span></code>
    <span style='
font-family:"Verdana",sans-serif;color:black'>.<o:p></o:p></span></p>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>For the given sample input the first map emits:<o:p></o:p></span></p>
<pre style='background:white'>
    <span style='color:black'>&lt; Hello, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; World, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; Bye, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; World, 1&gt;<o:p></o:p></span></pre>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>The second map emits:<o:p></o:p></span></p>
<pre style='background:white'>
    <span style='color:black'>&lt; Hello, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; Hadoop, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; Goodbye, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; Hadoop, 1&gt;<o:p></o:p></span></pre>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>We’ll learn more about the number of maps spawned for a given job,
and how to control them in a fine-grained manner, a bit later in the tutorial.<o:p></o:p></span></p>
<pre style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span><span
class=SpellE><span class=GramE>job.setCombinerClass</span></span>(<span
class=SpellE>IntSumReducer.class</span>);<o:p></o:p></span></pre>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'><span class=SpellE><code>
    <span style='
color:black'>WordCount</span></code></span>
    <span style='
font-family:"Verdana",sans-serif;color:black'>&nbsp;also specifies a&nbsp;</span><code><span
style='color:black'>combiner</span></code><span
style='font-family:"Verdana",sans-serif;color:black'>. Hence,
the output of each map is passed through the local combiner (which is same as
the&nbsp;</span><code>
    <span style='color:black'>Reducer</span></code><span
style='font-family:"Verdana",sans-serif;color:black'>&nbsp;as
per the job configuration) for local aggregation, after being sorted on
the&nbsp;<i>key</i>s.<o:p></o:p></span></p>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>The output of the first map:<o:p></o:p></span></p>
<pre style='background:white'>
    <span style='color:black'>&lt; Bye, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; Hello, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; World, 2&gt;<o:p></o:p></span></pre>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>The output of the second map:<o:p></o:p></span></p>
<pre style='background:white'>
    <span style='color:black'>&lt; Goodbye, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; Hadoop, 2&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; Hello, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>public void <span
class=GramE>reduce(</span>Text key, <span class=SpellE>Iterable</span>&lt;<span
class=SpellE>IntWritable</span>&gt; values,<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>                   </span>Context <span
class=SpellE>context</span><o:p></o:p></span></pre><pre style='background:white'><span
style='color:black'>
    <span style='mso-spacerun:yes'>                   </span>) <span
class=GramE>throws</span> <span class=SpellE>IOException</span>, <span
class=SpellE>InterruptedException</span> {<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span>int sum = <span
class=GramE>0;</span><o:p></o:p></span></pre><pre style='background:white'><span
style='color:black'>
    <span style='mso-spacerun:yes'>  </span>for (<span
class=SpellE>IntWritable</span> <span class=SpellE><span class=GramE>val</span></span><span
class=GramE> :</span> values) {<o:p></o:p></span></pre><pre style='background:
white'>
    <span style='color:black'><span style='mso-spacerun:yes'>    </span>sum += <span
class=SpellE><span class=GramE>val.get</span></span><span class=GramE>(</span>);<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span>}<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span><span
class=SpellE>result.set</span>(sum<span class=GramE>);</span><o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'><span style='mso-spacerun:yes'>  </span><span
class=SpellE><span class=GramE>context.write</span></span>(key, result);<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>}<o:p></o:p></span></pre>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>The&nbsp;</span><code>
    <span style='color:black'>Reducer</span></code><span
style='font-family:"Verdana",sans-serif;color:black'>&nbsp;implementation,
via the&nbsp;</span><code>
    <span style='color:black'>reduce</span></code><span
style='font-family:"Verdana",sans-serif;color:black'>&nbsp;method
just sums up the values, which are the occurrence counts for each key (<span
class=GramE>i.e.</span> words in this example).<o:p></o:p></span></p>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'><span class=GramE>
    <span style='font-family:
"Verdana",sans-serif;color:black'>Thus</span></span>
    <span style='font-size:
13.0pt;font-family:"Verdana",sans-serif;color:black'> the output of the job is:<o:p></o:p></span></p>
<pre style='background:white'>
    <span style='color:black'>&lt; Bye, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; Goodbye, 1&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; Hadoop, 2&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; Hello, 2&gt;<o:p></o:p></span></pre><pre
style='background:white'>
    <span style='color:black'>&lt; World, 2&gt;<o:p></o:p></span></pre>
<p class=MyNormal >
    <span style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";</o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>The&nbsp;</span><code><span
style='color:black'>main</span></code>
    <span style='font-size:
13.0pt;color:black'>&nbsp;method specifies various facets of the job, such as
the input/output paths (passed via the command line), key/value types,
input/output formats etc., in the&nbsp;</span><code>
    <span style='font-size:
13.0pt;color:black'>Job</span></code>
    <span style='color:black'>.
It then calls the&nbsp;</span><span class=SpellE><span class=GramE><code><span
style='color:black'>job.waitForCompletion</span></code></span></span><span
style='color:black'>&nbsp;to submit the job and monitor its
progress.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>We’ll
learn more about&nbsp;</span><code>
    <span style='color:black'>Job</span></code><span
style='color:black'>,&nbsp;</span><span class=SpellE><code><span
style='color:black'>InputFormat</span></code></span><span
style='color:black'>,&nbsp;</span><span class=SpellE><code><span
style='color:black'>OutputFormat</span></code></span><span
style='color:black'>&nbsp;and other interfaces and classes a
bit later in the tutorial.<o:p></o:p></span></p>
<h2 style='background:white;font-variant-ligatures: normal;font-variant-caps: normal;
orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'><a name="MapReduce_-_User_Interfaces"></a><span
style='font-size:18.0pt;font-family:"Verdana",sans-serif;color:#333333'></section></section><section>MapReduce
- User Interfaces<o:p></o:p></span></h2>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>This section provides a reasonable amount of detail on every
user-facing aspect of the MapReduce framework. This should help users
implement, <span class=GramE>configure</span> and tune their jobs in a
fine-grained manner. However, please note that the <span class=SpellE>javadoc</span>
for each class/interface remains the most comprehensive documentation
available; this is only meant to be a tutorial.<o:p></o:p></span></p>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>Let us first take the&nbsp;</span><code>
    <span style='font-size:
13.0pt;color:black'>Mapper</span></code>
    <span style='font-family:
"Verdana",sans-serif;color:black'>&nbsp;and&nbsp;</span><code><span
style='color:black'>Reducer</span></code><span
style='font-family:"Verdana",sans-serif;color:black'>&nbsp;interfaces.
Applications typically implement them to provide the&nbsp;</span><code><span
style='color:black'>map</span></code>
    <span style='font-size:
13.0pt;font-family:"Verdana",sans-serif;color:black'>&nbsp;and&nbsp;</span><code><span
style='color:black'>reduce</span></code>
    <span style='font-size:
13.0pt;font-family:"Verdana",sans-serif;color:black'>&nbsp;methods.<o:p></o:p></span></p>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>We will then discuss other core interfaces including&nbsp;</span><code><span
style='color:black'>Job</span></code>
    <span style='font-size:
13.0pt;font-family:"Verdana",sans-serif;color:black'>,&nbsp;</span><code><span
style='color:black'>Partitioner</span></code><span
style='font-family:"Verdana",sans-serif;color:black'>,&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>InputFormat</span></code></span><span
style='font-family:"Verdana",sans-serif;color:black'>,&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>OutputFormat</span></code></span><span
style='font-family:"Verdana",sans-serif;color:black'>, and
others.<o:p></o:p></span></p>
<p style='line-height:inherit;background:white;font-variant-ligatures: normal;
font-variant-caps: normal;orphans: 2;
 text-align:start;widows: 2;-webkit-text-stroke-width: 0px;
text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;
word-spacing:0px'>
    <span style='font-family:"Verdana",sans-serif;
color:black'>Finally, we will wrap up by discussing some useful features of the
framework such as the&nbsp;</span><span class=SpellE><code><span
style='color:black'>DistributedCache</span></code></span><span
style='font-family:"Verdana",sans-serif;color:black'>,&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>IsolationRunner</span></code></span><span
style='font-family:"Verdana",sans-serif;color:black'>&nbsp;etc.<o:p></o:p></span></p>
<h3 style='background:#CCCCCC;background-position-x:0%;background-position-y:
100%'><a name=Payload></a>
    <span style='font-size:16.0pt;color:#666666'><section style="color: rgb(0, 0, 0); font-family: Verdana, Helvetica, Arial, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">Payload</span><span
style='font-size:16.0pt;font-family:"Times New Roman",serif;mso-bidi-theme-font:
major-bidi;color:#666666'><o:p></o:p></span></h3>
<p style='line-height:inherit'>
    <span style='color:black'>Applications
typically implement the&nbsp;</span><code>
    <span style='
color:black'>Mapper</span></code>
    <span style='color:black'>&nbsp;and&nbsp;</span><code><span
style='color:black'>Reducer</span></code><span
style='color:black'>&nbsp;interfaces to provide the&nbsp;</span><code><span
style='color:black'>map</span></code>
    <span style='font-size:
13.0pt;color:black'>&nbsp;and&nbsp;</span><code>
    <span style='
color:black'>reduce</span></code>
    <span style='color:black'>&nbsp;methods.
These form the core of the job.<o:p></o:p></span></p>
<h4><a name=Mapper></a><section>Mapper
    <span style='color:windowtext'><o:p></o:p></span></h4>
<p style='line-height:inherit'>
    <span style='color:black'><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Mapper.html"><span
style='color:#4477AA'>Mapper</span></a>&nbsp;maps input key/value pairs to a
set of intermediate key/value pairs.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Maps
are the individual tasks that transform input records into intermediate
records. The transformed intermediate records do not need to be of the same
type as the input records. A given input pair may map to zero or many output
pairs.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>The
Hadoop MapReduce framework spawns one map task for each&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>InputSplit</span></code></span><span
style='color:black'>&nbsp;generated by the&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>InputFormat</span></code></span><span
style='color:black'>&nbsp;for the job.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Overall,
mapper implementations are passed to the job via&nbsp;<span class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Job.html"><span
style='color:#4477AA'>Job.setMapperClass</span>
    <span style='color:#4477AA'>(Class)</span></a></span>&nbsp;method.
The framework then calls&nbsp;<a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Mapper.html"><span
style='color:#4477AA'>map(<span class=SpellE>WritableComparable</span>,
Writable, Context)</span></a>&nbsp;for each key/value pair in the&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>InputSplit</span></code></span><span
style='color:black'>&nbsp;for that task. Applications can then
override the&nbsp;</span><span class=GramE><code>
    <span style='
color:black'>cleanup(</span></code></span><code>
    <span style='
color:black'>Context)</span></code>
    <span style='color:black'>&nbsp;method
to perform any required cleanup.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Output
pairs do not need to be of the same types as input pairs. A given input pair
may map to zero or many output pairs. Output pairs are collected with calls to <span
class=SpellE><span class=GramE>context.write</span></span>(<span class=SpellE>WritableComparable</span>,
Writable).<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Applications
can use the&nbsp;</span><code>
    <span style='color:black'>Counter</span></code><span
style='color:black'>&nbsp;to report its statistics.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>All
intermediate values associated with a given output key are subsequently grouped
by the <span class=GramE>framework, and</span> passed to the&nbsp;</span><code><span
style='color:black'>Reducer</span></code><span
style='color:black'>(s) to determine the final output. Users
can control the grouping by specifying a&nbsp;</span><code><span
style='color:black'>Comparator</span></code><span
style='color:black'>&nbsp;via&nbsp;<span class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Job.html"><span
style='color:#4477AA'>Job.setGroupingComparatorClass</span><span
style='color:#4477AA'>(Class)</span></a></span>.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>The&nbsp;</span><code><span
style='color:black'>Mapper</span></code>
    <span style='font-size:
13.0pt;color:black'>&nbsp;outputs are sorted and then partitioned per&nbsp;</span><code><span
style='color:black'>Reducer</span></code><span
style='color:black'>. The total number of partitions is the
same as the number of reduce tasks for the job. Users can control which keys
(and hence records) go to which&nbsp;</span><code>
    <span style='
color:black'>Reducer</span></code>
    <span style='color:black'>&nbsp;by
implementing a custom&nbsp;</span><code>
    <span style='
color:black'>Partitioner</span></code>
    <span style='color:black'>.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Users
can optionally specify a&nbsp;</span><code>
    <span style='
color:black'>combiner</span></code>
    <span style='color:black'>,
via&nbsp;<span class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Job.html"><span
style='color:#4477AA'>Job.setCombinerClass</span>
    <span style='color:#4477AA'>(Class)</span></a></span>,
to perform local aggregation of the intermediate outputs, which helps to cut
down the amount of data transferred from the&nbsp;</span><code><span
style='color:black'>Mapper</span></code>
    <span style='font-size:
13.0pt;color:black'>&nbsp;to the&nbsp;</span><code>
    <span style='
color:black'>Reducer</span></code>
    <span style='color:black'>.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>The
intermediate, sorted outputs are always stored in a simple (key-<span
class=SpellE>len</span>, key, value-<span class=SpellE>len</span>, value)
format. Applications can control if, and how, the intermediate outputs are to
be compressed and the&nbsp;<span class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/io/compress/CompressionCodec.html"><span
style='color:#4477AA'>CompressionCodec</span></a></span>&nbsp;to be used via
the&nbsp;</span><code>
    <span style='color:black'>Configuration</span></code><span
style='color:black'>.<o:p></o:p></span></p>
<h5 class=bluey>How Many Maps?</h5>
<p style='line-height:inherit'>
    <span style='color:black'>The
number of maps is usually driven by the total size of the inputs, that is, the
total number of blocks of the input files.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>The
right level of parallelism for maps seems to be around 10-100 maps per-node,
although it has been set up to 300 maps for very <span class=SpellE>cpu</span>-light
map tasks. Task setup takes a while, so it is best if the maps take at least a
minute to execute.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Thus,
if you expect 10TB of input data and have a <span class=SpellE>blocksize</span>
of&nbsp;</span><code>
    <span style='color:black'>128MB</span></code><span
style='color:black'>, you’ll end up with 82,000 maps, unless <span
class=SpellE><span class=GramE>Configuration.set</span></span><span
class=GramE>(</span></span><span class=SpellE><code>
    <span style='font-size:
13.0pt;color:black'>MRJobConfig.NUM_MAPS</span></code></span><span
style='color:black'>, int) (which only provides a hint to the
framework) is used to set it even higher.<o:p></o:p></span></p>
<h4><a name=Reducer></a></section></section><section>Reducer<span
style='color:windowtext'><o:p></o:p></span></h4>
<p style='line-height:inherit'>
    <span style='color:black'><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Reducer.html"><span
style='color:#4477AA'>Reducer</span></a>&nbsp;reduces a set of intermediate
values which share a key to a smaller set of values.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>The
number of reduces for the job is set by the user via&nbsp;<span class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Job.html"><span
style='color:#4477AA'>Job.setNumReduceTasks</span>
    <span style='color:#4477AA'>(int)</span></a></span>.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Overall,&nbsp;</span><code><span
style='color:black'>Reducer</span></code><span
style='color:black'>&nbsp;implementations are passed the&nbsp;</span><code><span
style='color:black'>Job</span></code>
    <span style='font-size:
13.0pt;color:black'>&nbsp;for the job via the&nbsp;<span class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Job.html"><span
style='color:#4477AA'>Job.setReducerClass</span>
    <span style='color:#4477AA'>(Class)</span></a></span>&nbsp;method
and can override it to initialize themselves. The framework then calls&nbsp;<a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Reducer.html"><span
style='color:#4477AA'>reduce(<span class=SpellE>WritableComparable</span>, <span
class=SpellE>Iterable</span>&lt;Writable&gt;, Context)</span></a>&nbsp;method
for each&nbsp;</span><code>
    <span style='color:black'>&lt;key,
(list of values)&gt;</span></code>
    <span style='color:black'>&nbsp;pair
in the grouped inputs. Applications can then override the&nbsp;</span><span
class=GramE><code>
    <span style='color:black'>cleanup(</span></code></span><code><span
style='color:black'>Context)</span></code><span
style='color:black'>&nbsp;method to perform any required
cleanup.<o:p></o:p></span></p>
<p style='line-height:inherit'><code>
    <span style='color:black'>Reducer</span></code><span
style='color:black'>&nbsp;has 3 primary phases: shuffle, sort
and reduce.<o:p></o:p></span></p>
<h5 class=bluey>Shuffle</h5>

<p style='line-height:inherit'>
    <span style='color:black'>Input to the&nbsp;</span>
    <code><span style='color:black'>Reducer</span></code>
    <span style='color:black'>&nbsp;is the sorted output of the mappers.
In this phase the framework fetches the relevant partition of the output of all
the mappers, via HTTP.<o:p></o:p></span></p>

<h5 class=bluey>Sort</h5>
<p style='line-height:inherit'>
    <span style='color:black'>The
framework groups&nbsp;</span><code>
    <span style='color:black'>Reducer</span></code><span
style='color:black'>&nbsp;inputs by keys (since different
mappers may have output the same key) in this stage.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>The
shuffle and sort phases occur simultaneously; while map-outputs are being
fetched they are merged.<o:p></o:p></span></p>


<h5 class=bluey>Secondary Sort</h5>
<p style='line-height:inherit'>
    <span style='color:black'>If
equivalence rules for grouping the intermediate keys are required to be
different from those for grouping keys before reduction, then one may specify
a&nbsp;</span><code>
    <span style='color:black'>Comparator</span></code><span
style='color:black'>&nbsp;via&nbsp;<span class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Job.html"><span
style='color:#4477AA'>Job.setSortComparatorClass</span>
    <span style='color:#4477AA'>(Class)</span></a></span>.
Since&nbsp;<span class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Job.html"><span
style='color:#4477AA'>Job.setGroupingComparatorClass</span><span
style='color:#4477AA'>(Class)</span></a></span>&nbsp;can be used to control how
intermediate keys are grouped, these can be used in conjunction to
simulate&nbsp;<i>secondary sort on values</i>.<o:p></o:p></span></p>
<h5 class=bluey>Reduce</h5>
<p style='line-height:inherit'>
    <span style='color:black'>In this
phase the <span class=GramE>reduce(</span><span class=SpellE>WritableComparable</span>,
<span class=SpellE>Iterable</span>&lt;Writable&gt;, Context) method is called
for each&nbsp;</span><code>
    <span style='color:black'>&lt;key,
(list of values)&gt;</span></code>
    <span style='color:black'>&nbsp;pair
in the grouped inputs.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>The
output of the reduce task is typically written to the&nbsp;<span class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/fs/FileSystem.html"><span
style='color:#4477AA'>FileSystem</span></a></span>&nbsp;via <span class=SpellE>Context.write</span>(<span
class=SpellE>WritableComparable</span>, Writable).<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Applications
can use the&nbsp;</span><code>
    <span style='color:black'>Counter</span></code><span
style='color:black'>&nbsp;to report its statistics.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>The
output of the&nbsp;</span><code>
    <span style='color:black'>Reducer</span></code><span
style='color:black'>&nbsp;is&nbsp;<i>not sorted</i>.<o:p></o:p></span></p>

<h5 class=bluey>How Many Reduces?</h5>
<p style='line-height:inherit'>
    <span style='color:black'>The
right number of reduces seems to be&nbsp;</span><code>
    <span style='font-size:13.0pt;color:black'>0.95</span></code>
    <span style='color:black'>&nbsp;or&nbsp;</span><code><span
style='color:black'>1.75</span></code>
    <span style='font-size:13.0pt;color:black'>&nbsp;multiplied by (&lt;<i>no. of nodes</i>&gt; * &lt;<i>no.
of maximum containers per node</i>&gt;).<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>With&nbsp;</span><code><span
style='color:black'>0.95</span></code>
    <span style='font-size:13.0pt;color:black'>&nbsp;<span class=GramE>all of</span> the reduces can launch
immediately and start transferring map outputs as the maps finish. With&nbsp;</span><code><span
style='color:black'>1.75</span></code>
    <span style='font-size:
13.0pt;color:black'>&nbsp;the faster nodes will finish their first round of
reduces and launch a second wave of reduces doing a much better job of load
balancing.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Increasing
the number of reduces increases the framework <span class=GramE>overhead, but</span>
increases load balancing and lowers the cost of failures.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>The
scaling factors above are slightly less than whole numbers to reserve a few
reduce slots in the framework for speculative-tasks and failed tasks.<o:p></o:p></span></p>
<h5 class=bluey>Reducer NONE</h5>
<p style='line-height:inherit'>
    <span style='color:black'>It is
legal to set the number of reduce-tasks to&nbsp;<i>zero</i>&nbsp;if no
reduction is desired.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>In this
case the outputs of the map-tasks go directly to the&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>FileSystem</span></code></span><span
style='color:black'>, into the output path set by&nbsp;<span
class=SpellE><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/lib/output/FileOutputFormat.html"><span
style='color:#4477AA'>FileOutputFormat.setOutputPath</span><span
style='color:#4477AA'>(Job, Path)</span></a></span>. The framework does not
sort the map-outputs before writing them out to the&nbsp;</span><span
class=SpellE><code>
    <span style='color:black'>FileSystem</span></code></span><span
style='color:black'>.<o:p></o:p></span></p>
<h4><a name=Partitioner></a></section></section><section>Partitioner<span
style='color:windowtext'><o:p></o:p></span></h4>
<p style='line-height:inherit'>
    <span style='color:black'><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Partitioner.html"><span
style='color:#4477AA'>Partitioner</span></a>&nbsp;partitions the key space.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Partitioner
controls the partitioning of the keys of the intermediate map-outputs. The key
(or a subset of the key) is used to derive the partition, typically by a&nbsp;<i>hash
function</i>. The total number of partitions is the same as the number of
reduce tasks for the job. Hence this controls which of the&nbsp;</span><code><span
style='color:black'>m</span></code>
    <span style='
color:black'>&nbsp;reduce tasks the intermediate key (and hence the record) is
sent to for reduction.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/lib/partition/HashPartitioner.html"><span
class=SpellE>
    <span style='color:#4477AA'>HashPartitioner</span></span></a>&nbsp;is
the default&nbsp;</span><code>
    <span style='color:black'>Partitioner</span></code><span
style='color:black'>.<o:p></o:p></span></p>
<h4><a name=Counter></a></section><section>Counter
    <span style='color:windowtext'><o:p></o:p></span></h4>
<p style='line-height:inherit'>
    <span style='color:black'><a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/Counter.html"><span
style='color:#4477AA'>Counter</span></a>&nbsp;is a facility for MapReduce
applications to report its statistics.<o:p></o:p></span></p>
<p style='line-height:inherit'><code>
    <span style='color:black'>Mapper</span></code><span
style='color:black'>&nbsp;and&nbsp;</span><code><span
style='color:black'>Reducer</span></code><span
style='color:black'>&nbsp;implementations can use the&nbsp;</span><code><span
style='color:black'>Counter</span></code><span
style='color:black'>&nbsp;to report statistics.<o:p></o:p></span></p>
<p style='line-height:inherit'>
    <span style='color:black'>Hadoop
MapReduce comes bundled with a&nbsp;<a
href="https://hadoop.apache.org/docs/stable/api/org/apache/hadoop/mapreduce/package-summary.html"><span
style='color:#4477AA'>library</span></a>&nbsp;of generally useful mappers,
reducers, and partitioners.<o:p></o:p></span></p>
<p class=MyNormal ><o:p>&nbsp;</o:p></p>
</section></section><section style="color: rgb(0, 0, 0); font-family: Verdana, Helvetica, Arial, sans-serif; font-size: 18px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; white-space: normal; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">
<p class=MyNormal >
    <span style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";</o:p></span></p>
<p class=MyNormal >
    <span style='font-family:"Times New Roman",serif;mso-fareast-font-family:
"Times New Roman";</o:p></span></p>
<p class=MyNormal ><o:p>&nbsp;</o:p></p>
<p class=MyNormal ><o:p>&nbsp;</o:p></p>
</div>
</body>
</html>
